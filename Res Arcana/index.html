<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Res Arcana</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div id="game-container">
        <!-- Draft section (shown during draft phases, hidden during play) -->
        <div id="draft-section" class="hidden">
            <h2 id="draft-title">Drafting</h2>
            <p id="draft-instructions"></p>

            <!-- Cards to pick from (draft phase) -->
            <div id="draft-cards" class="hidden">
                <div class="zone-label">Choose a card:</div>
                <div id="draft-card-options" class="card-selection"></div>
            </div>

            <!-- Mage selection -->
            <div id="mage-selection" class="hidden">
                <div class="zone-label">Choose your mage:</div>
                <div id="mage-options" class="card-selection"></div>
            </div>

            <!-- Magic item selection -->
            <div id="magic-item-selection" class="hidden">
                <div class="zone-label">Choose a magic item:</div>
                <div id="magic-item-options" class="card-selection"></div>
            </div>

            <!-- Your mage options (visible during draft) -->
            <div id="your-mages" class="hidden">
                <div class="zone-label">Your mage options:</div>
                <div id="your-mage-cards"></div>
            </div>

            <!-- Drafted cards display -->
            <div id="drafted-display">
                <div class="zone-label">Your drafted cards:</div>
                <div id="drafted-cards"></div>
            </div>

            <!-- Waiting indicator -->
            <div id="waiting-indicator" class="hidden">
                <p>Waiting for other players...</p>
            </div>
        </div>

        <!-- Income section (shown during income phase) -->
        <div id="income-section" class="hidden">
            <h2 id="income-title">Income Phase</h2>
            <p id="income-instructions"></p>

            <!-- Cards with stored resources to collect -->
            <div id="income-collection" class="hidden">
                <div class="zone-label">Collect resources from cards (click to toggle):</div>
                <div id="income-collection-cards" class="income-cards"></div>
            </div>

            <!-- Fixed income (informational) -->
            <div id="income-fixed" class="hidden">
                <div class="zone-label">Automatic income:</div>
                <div id="income-fixed-cards" class="income-cards"></div>
            </div>

            <!-- Income choices -->
            <div id="income-choices" class="hidden">
                <div class="zone-label">Choose income:</div>
                <div id="income-choice-cards" class="income-cards"></div>
            </div>

            <!-- Preferences -->
            <div id="income-prefs">
                <label>
                    <input type="checkbox" id="auto-skip-pop" checked onchange="toggleAutoSkipPoP()">
                    Auto-skip Places of Power resource collection
                </label>
            </div>

            <!-- Action buttons -->
            <div id="income-actions">
                <button id="income-wait-btn" onclick="waitForEarlierPlayers()">Wait for Earlier Players</button>
                <button id="income-finalize-btn" onclick="finalizeIncome()">Finalize</button>
            </div>

            <!-- Status -->
            <div id="income-status"></div>
        </div>

        <!-- Your area (top) -->
        <div id="player-area" class="player-area">
            <div class="area-label" id="player-label">Player 1 (You)</div>
            <div class="player-info-bar">
                <div class="player-resources" id="player-resources"></div>
                <div class="first-player-slot" id="player-token-slot"></div>
            </div>
            <div class="player-board">
                <div class="side-piles">
                    <div class="discard-area" id="player-discard">
                        <div class="zone-label">Discard</div>
                        <div class="discard-cards"></div>
                    </div>
                    <div class="deck" id="player-deck">
                        <span class="deck-label">Deck</span>
                        <span class="deck-count">0</span>
                    </div>
                </div>
                <div class="controlled-cards" id="player-controlled"></div>
                <div class="player-scrolls" id="player-scrolls"></div>
            </div>
            <div class="hand-area" id="player-hand">
                <div class="zone-label">Hand</div>
                <div class="hand-cards"></div>
            </div>
        </div>

        <!-- Shared zones (middle) -->
        <div id="shared-area">
            <div class="shared-zone" id="monuments-zone">
                <div class="zone-label">Monuments</div>
                <div class="zone-cards">
                    <div class="deck" id="monument-deck">
                        <span class="deck-label">Deck</span>
                        <span class="deck-count"></span>
                    </div>
                    <div id="available-monuments"></div>
                </div>
            </div>
            <div class="shared-zone" id="places-of-power-zone">
                <div class="zone-label">Places of Power</div>
                <div class="zone-cards" id="available-places"></div>
            </div>
            <div class="shared-zone secondary-zone" id="magic-items-zone">
                <div class="zone-label">Magic Items</div>
                <div class="zone-cards" id="available-magic-items"></div>
            </div>
            <div class="shared-zone secondary-zone" id="scrolls-zone">
                <div class="zone-label">Scrolls</div>
                <div class="zone-cards" id="available-scrolls"></div>
            </div>
        </div>

        <!-- Opponents area (bottom) - dynamically populated -->
        <div id="opponents-container"></div>
    </div>

    <!-- Debug panel -->
    <div id="debug-panel">
        <button id="debug-toggle" onclick="toggleDebug()">Debug â–¶</button>
        <div id="debug-content">
            <div class="debug-section">
                <h3>New Game</h3>
                <label>Players</label>
                <select id="new-game-players" onchange="updatePlayAsOptions()">
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                </select>
                <label>Play As</label>
                <select id="play-as-player">
                    <option value="0">Player 1</option>
                    <option value="1">Player 2</option>
                </select>
                <button onclick="newGameFromUI()">Start New Game</button>
            </div>
            <div class="debug-section">
                <h3>View As</h3>
                <select id="view-as-player" onchange="switchViewingPlayer(this.value)">
                    <option value="0">Player 1</option>
                    <option value="1">Player 2</option>
                </select>
            </div>
            <div class="debug-section">
                <h3>Game Actions</h3>
                <button onclick="startIncomePhase()">Start Income Phase</button>
            </div>
            <div class="debug-section">
                <h3>Visible State (Player View)</h3>
                <pre id="visible-state"></pre>
            </div>
            <div class="debug-section">
                <h3>Full State (Debug)</h3>
                <pre id="full-state"></pre>
            </div>
        </div>
    </div>

    <script src="renderer.js"></script>
</body>
</html>
